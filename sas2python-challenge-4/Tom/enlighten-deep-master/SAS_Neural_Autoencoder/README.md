/******************************************************************************

Copyright (c) 2015 by SAS Institute Inc., Cary, NC 27513 USA

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

******************************************************************************/

===============

SAS_NEURAL_Autoencoder

===============

Code and materials for approximating a stacked autoencoder with SAS
Enterprise Miner PROC NEURAL.

This code approximates methods similar to those put forth in:
- Hinton, G. E. and Salakhutdinov, R. R. 2006. “Reducing the Dimensionality
of Data with Neural Networks.” Science 313:504–507.

- Vincent, Pascal, et al. "Extracting and composing robust features with
denoising autoencoders." Proceedings of the 25th international conference
on Machine learning. ACM, 2008.

These examples where tested in the following environment:

Windows Server 2008 R2 Enterprise

Dual Intel Xeon E5-2667 @ 2.9 GHz

128 GB RAM 

SAS 9.4 (TS1M2)

SAS Enterprise Miner 13.2

===============

This code was first used as a demo at KDD 2014.

It was developed as part of a solution for the Cloudera Data Science
Challenge 2:

http://www.cloudera.com/content/cloudera/en/training/certification/ccp-ds/challenge/challenge2.html

===============

INSTRUCTIONS:

1.) Download (and unzip) or clone the enlighten-deep repository.

2.) Open the SAS_NEURAL_Autoencoder.sas file in a standard DMS SAS Session. 

3.) Set the git_repo_dir macro variable to this subdirectory of the
repository.

4.) Set the num_cores macro variable to an integer less than or equal to the
number of physical CPU cores on your system.

5.) OPTIONAL: Set the num_outiers macro variable to the number of outlying
medical providers you would like to find.

6.) Submit the entire file. 

Discussion of Results:

Two distance-based unsupervised learning approaches are used to identify
medicare providers that were the most different from all other medicare
providers in the training data:

a.) The entire Euclidean distance matrix of the given feature space is
calculated using the DISTANCE procedure in SAS/STAT.

b.) To supplement these findings, the FASTCLUS procedure in SAS/STAT is
used to apply k-means clustering to the same training data.

(In a separate analysis, the aligned box criterion (ABC) was used to estimate
the best number of clusters - 16 - for this particular feature space. The
aligned box criterion is available through the NOC option of the HPLCUS
procedure in SAS Enterprise Miner, but is not shown here.)

The clustering results enabled the pinpointing of the furthest Euclidean
distance outliers that also formed their own cluster far from other
clusters.

To visualize the combined results of both approaches, the NEURAL procedure in
SAS Enterprise Miner is used to approximate a type of deep neural network,
known as a stacked autoencoder, to accurately project the newly labeled points
from the given feature space into a two-dimensional space.

The generated plot is an optimal, nonlinear, two-dimensional projection of the
provider training data which contains Medicare billing information, the number
and severity of procedures billed, and an indicator of whether the provider is
a university hospital. Because the new axes were generated by a large neural
network in which the input features are recombined many times over, they are quite
difficult to interpret. 

That certain points were placed in their own clusters by the k-means method using
ABC to estimate the best number of clusters is especially significant because
the k-means method prefers spherical clusters of a similar size. In short,
there is statistical support for the hypothesis that these providers are
unique.

For a more detailed discussion of the entire analysis please see:
http://support.sas.com/resources/papers/proceedings15/SAS2520-2015.pdf